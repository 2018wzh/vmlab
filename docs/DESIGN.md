# VMLab 前端设计文档

## 1. 设计哲学与原则

VMLab的前端设计将严格遵循 **Material Design** 设计语言，旨在提供一个现代化、直观、信息清晰且响应式的用户界面。

- **一致性**: 界面元素和交互模式在整个应用中保持一致。
- **清晰度**: 信息架构清晰，用户可以轻松找到所需功能，避免不必要的复杂性。
- **响应式**: 完美适配桌面、平板和移动设备，确保在不同屏幕尺寸下都有一致的用户体验。
- **用户中心**: 根据不同角色（学生、教师、管理员）的需求，定制化展示信息和功能，提供高效的工作流。

## 2. 色彩与字体

- **主色调**:
  - `Primary`: `#2196F3` (蓝色) - 用于导航栏、按钮、链接等关键交互元素。
  - `Secondary`: `#FFC107` (琥珀色) - 用于浮动操作按钮、高亮提示等。
- **辅助色**:
  - `Success`: `#4CAF50` (绿色) - 用于成功提示、在线状态。
  - `Warning`: `#FF9800` (橙色) - 用于警告信息。
  - `Error`: `#F44336` (红色) - 用于错误提示、离线状态。
  - `Background`: `#F5F5F5` (浅灰色) - 页面背景色。
  - `Surface`: `#FFFFFF` (白色) - 卡片、对话框等表面颜色。
- **字体**:
  - `Font Family`: `Roboto, "Helvetica Neue", Arial, sans-serif` - Material Design 默认字体。
  - `代码字体`: `Fira Code, Consolas, Monaco, monospace` - 用于显示代码和终端输出。

## 3. 整体布局

采用经典的后台管理系统布局，包含顶部应用栏和左侧导航栏。

```mermaid
graph TD
    A[整体页面] --> B[顶部应用栏 (AppBar)];
    A --> C[左侧导航栏 (Navigation Drawer)];
    A --> D[主内容区 (Main Content)];

    B --> B1[Logo/标题];
    B --> B2[面包屑导航];
    B --> B3[通知中心];
    B --> B4[用户菜单 (个人资料/登出)];

    subgraph "左侧导航栏 (根据角色显示)"
        C --> C1[主仪表盘 (Dashboard)];
        C --> C2[课程管理];
        C --> C3[虚拟机管理];
        C --> C4[用户管理 (管理员)];
        C --> C5[模板管理 (教师/管理员)];
        C --> C6[系统设置 (管理员)];
    end
```

- **顶部应用栏**: 固定在页面顶部，显示Logo、当前页面标题（面包屑）、通知中心、以及用户头像和菜单（个人资料、登出）。
- **左侧导航栏**: 可展开和收缩，根据用户角色动态显示导航项。
- **主内容区**: 占据剩余空间，用于显示页面具体内容。

## 4. 角色与权限 UI 设计

UI界面将根据用户角色动态调整，以提供最佳的用户体验并执行权限控制。

- **学生 (Student)**:
  - **导航栏**: 只能看到 `主仪表盘`, `我的课程`, `我的虚拟机`。
  - **操作**: 只能创建和管理自己的虚拟机，无法查看或操作他人的虚拟机。可以在课程中查看教师分配的模板。
  - **仪表盘**: 显示个人资源配额使用情况、课程列表和虚拟机列表。

- **教师 (Teacher)**:
  - **导航栏**: 包含 `主仪表盘`, `课程管理`, `虚拟机管理`, `模板管理`。
  - **操作**: 可以创建和管理自己的课程，向课程中添加/移除学生。可以查看和管理其课程下所有学生的虚拟机（如启动、停止、查看控制台）。可以上传和管理虚拟机模板并将其分配给课程。
  - **仪表盘**: 显示所教课程的概览、学生虚拟机状态统计、最近学生活动等。

- **管理员 (Admin)**:
  - **导航栏**: 拥有所有导航项，包括 `用户管理` 和 `系统设置`。
  - **操作**: 拥有最高权限，可以管理所有用户、课程、虚拟机和模板。可以配置系统设置、分配用户角色和资源配额。
  - **仪表盘**: 显示系统级的监控信息，如资源总览、用户统计、平台活动日志等。

## 5. 页面设计草图

### 5.1 登录/注册页

- **布局**: 页面居中卡片式设计。
- **元素**:
  - VMLab Logo 和标题。
  - 输入框：用户名/邮箱、密码。
  - "登录" 按钮。
  - 切换到 "注册" 和 "忘记密码" 的链接。

### 5.2 主仪表盘 (Dashboard)

- **布局**: 卡片式网格布局，根据角色显示不同卡片。
- **通用卡片**:
  - "欢迎语" 和用户基本信息。
  - "快速操作"：如 "创建虚拟机" (学生)、"创建课程" (教师)。
- **学生视图**:
  - "我的虚拟机" 卡片列表 (显示名称和状态)。
  - "我的课程" 卡片列表。
  - "资源配额" 可视化图表 (环形图展示CPU、内存、磁盘使用情况)。
- **教师视图**:
  - "我教授的课程" 卡片列表。
  - "学生虚拟机概览" (统计在线/离线数量)。
  - "最近的学生活动" 时间线。
- **管理员视图**:
  - "系统状态" (主机、存储、网络健康度)。
  - "资源总览" (CPU、内存、磁盘总使用率)。
  - "用户/课程/虚拟机" 数量统计。

### 5.3 虚拟机列表页

- **布局**: 数据表格 (Data Table)。
- **功能**:
  - 顶部操作栏： "创建虚拟机" 按钮、搜索框、状态和课程的筛选器。
- **表格列**:
  - `名称`: 虚拟机名称，点击可进入详情页。
  - `状态`: 使用带颜色的状态芯片 (Chip) 显示 (如 `running` - 绿色, `stopped` - 灰色, `creating` - 蓝色)。
  - `所有者`: `owner_username`。
  - `IP地址`: `ip_address`。
  - `配置`: `CPU / 内存 / 磁盘`。
  - `所属课程`: `course_name`。
  - `使用模板`: `template_name`。
  - `创建时间`: `created_at`。
  - `操作`: 图标按钮组 (启动、停止、重启、暂停/恢复、控制台、删除)。

### 5.4 虚拟机详情页

- **布局**: 顶部信息概览 + 下方标签页 (Tabs)。
- **顶部概览**:
  - 虚拟机名称和状态。
  - 主要操作按钮 (启动/停止、重启、暂停/恢复)。
  - 关键信息：IP地址、所属课程、创建时间。
- **标签页**:
  1. **监控 (Monitoring)**:
     - 使用图表 (Chart.js/ECharts) 实时展示 CPU、内存、网络I/O、磁盘I/O 的历史和实时数据。
     - 可选择时间范围 (最近1小时、24小时、7天)。
  2. **控制台 (Console)**:
     - 嵌入式 `noVNC` 和 `WebSSH` 客户端。
     - 提供 "发送 Ctrl+Alt+Del" 等常用操作按钮。
  3. **快照 (Snapshots)**:
     - 快照列表，显示快照名称和创建时间。
     - 操作：创建快照、恢复到快照、删除快照。
  4. **设置 (Settings)**:
     - 查看和修改虚拟机配置 (名称、描述)。
     - 调整资源 (需要关机状态)。

### 5.5 课程列表页

- **布局**: 卡片式网格布局。
- **功能**:
  - 教师/管理员可看到 "创建课程" 按钮。
- **课程卡片**:
  - 课程名称、描述。
  - 授课教师头像和名称。
  - 学生数量、虚拟机数量统计。
  - 点击卡片进入课程详情页。

### 5.6 课程详情页

- **布局**: 顶部信息概览 + 下方标签页。
- **顶部概览**: 课程名称、描述、授课教师。
- **标签页**:
  1. **学生管理**:
     - 学生列表 (表格)。
     - 操作：添加/移除学生。
  2. **虚拟机模板**:
     - 模板列表 (卡片)。
     - 操作：上传新模板、编辑/删除模板、将模板关联到课程。
  3. **虚拟机列表**:
     - 该课程下所有学生的虚拟机列表。
     - 教师可以查看和管理这些虚拟机。
  4. **课程统计**:
     - 显示课程相关的统计数据，如虚拟机总数、运行中的虚拟机等。
  5. **设置**:
     - 编辑课程基本信息（名称、描述）。

### 5.7 用户管理页 (管理员)

- **布局**: 数据表格。
- **功能**:
  - "创建用户"、"批量导入" 按钮。
  - 搜索框、角色筛选器。
- **表格列**:
  - `用户名` / `邮箱`
  - `角色`
  - `状态` (激活/禁用)
  - `注册时间`
  - `操作`: 编辑、删除、修改配额。

## 6. 核心组件库

基于Material Design，我们将构建以下可复用组件：

- `StatusChip`: 带颜色和图标的状态指示器。
- `ResourceDonutChart`: 用于展示资源配额的环形图。
- `DataTable`: 支持排序、筛选、分页的数据表格。
- `ConfirmDialog`: 用于删除等危险操作的确认对话框。
- `CreateVMWizard`: 分步式虚拟机创建向导 (模态框)。
- `PageHeader`: 统一的页面顶部，包含标题、面包屑和操作按钮。
- `FileUploader`: 支持拖拽和进度显示的文件上传组件 (用于上传模板)。
- `Timeline`: 用于展示活动日志或事件。

## 7. 状态管理

- **全局状态**: 使用 `Pinia` (Vue) 或 `Redux Toolkit` (React) 管理全局状态，包括：
  - **认证信息**: 用户Token、用户信息（ID, 角色, 用户名）。
  - **系统通知**: 全局的消息、警告和错误。
  - **UI状态**: 左侧导航栏的展开/收缩状态。
- **领域状态 (Domain State)**:
  - **虚拟机状态**: 虚拟机列表及其每个虚拟机的实时状态。需要支持WebSocket或轮询进行实时更新。
  - **课程数据**: 用户所参与或教授的课程列表和详情。
  - **用户配额**: 当前用户的资源配额和已使用情况。
- **数据获取**: 使用 `axios` 或 `fetch` API 与后端交互。推荐结合 `SWR` (React) 或 `Vue-Query` (Vue) 等库来自动化管理数据缓存、重新验证和同步，以简化数据获取逻辑并提升用户体验。

